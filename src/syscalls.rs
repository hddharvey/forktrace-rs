//! Provides access to a list of syscall ID => name and arg count mappings.

/// Characterises a system call.
pub struct SyscallInfo {
    pub arg_count: usize,
    pub name: &'static str,
}

/// Returns the SyscallInfo associated with a system call ID.
///
/// Returns None if there was no system call associated with the provided ID.
pub fn get(id: usize) -> Option<&'static SyscallInfo> {
    if id >= NUM_SYSCALLS {
        return None;
    }
    return Some(&SYSCALLS[id]);
}

// this is all specific to x86_64
#[doc(hidden)]
const NUM_SYSCALLS: usize = 323;
#[doc(hidden)]
const SYSCALLS: [SyscallInfo; NUM_SYSCALLS] = [
    SyscallInfo { arg_count: 3, name: "read" },
    SyscallInfo { arg_count: 3, name: "write" },
    SyscallInfo { arg_count: 3, name: "open" },
    SyscallInfo { arg_count: 1, name: "close" },
    SyscallInfo { arg_count: 2, name: "stat" },
    SyscallInfo { arg_count: 2, name: "fstat" },
    SyscallInfo { arg_count: 2, name: "lstat" },
    SyscallInfo { arg_count: 3, name: "poll" },
    SyscallInfo { arg_count: 3, name: "lseek" },
    SyscallInfo { arg_count: 6, name: "mmap" },
    SyscallInfo { arg_count: 3, name: "mprotect" },
    SyscallInfo { arg_count: 2, name: "munmap" },
    SyscallInfo { arg_count: 1, name: "brk" },
    SyscallInfo { arg_count: 4, name: "rt_sigaction" },
    SyscallInfo { arg_count: 4, name: "rt_sigprocmask" },
    SyscallInfo { arg_count: 0, name: "rt_sigreturn" },
    SyscallInfo { arg_count: 3, name: "ioctl" },
    SyscallInfo { arg_count: 4, name: "pread" },
    SyscallInfo { arg_count: 4, name: "pwrite" },
    SyscallInfo { arg_count: 3, name: "readv" },
    SyscallInfo { arg_count: 3, name: "writev" },
    SyscallInfo { arg_count: 2, name: "access" },
    SyscallInfo { arg_count: 1, name: "pipe" },
    SyscallInfo { arg_count: 5, name: "select" },
    SyscallInfo { arg_count: 0, name: "sched_yield" },
    SyscallInfo { arg_count: 5, name: "mremap" },
    SyscallInfo { arg_count: 3, name: "msync" },
    SyscallInfo { arg_count: 3, name: "mincore" },
    SyscallInfo { arg_count: 3, name: "madvise" },
    SyscallInfo { arg_count: 3, name: "shmget" },
    SyscallInfo { arg_count: 3, name: "shmat" },
    SyscallInfo { arg_count: 3, name: "shmctl" },
    SyscallInfo { arg_count: 1, name: "dup" },
    SyscallInfo { arg_count: 2, name: "dup2" },
    SyscallInfo { arg_count: 0, name: "pause" },
    SyscallInfo { arg_count: 2, name: "nanosleep" },
    SyscallInfo { arg_count: 2, name: "getitimer" },
    SyscallInfo { arg_count: 1, name: "alarm" },
    SyscallInfo { arg_count: 3, name: "setitimer" },
    SyscallInfo { arg_count: 0, name: "getpid" },
    SyscallInfo { arg_count: 4, name: "sendfile" },
    SyscallInfo { arg_count: 3, name: "socket" },
    SyscallInfo { arg_count: 3, name: "connect" },
    SyscallInfo { arg_count: 3, name: "accept" },
    SyscallInfo { arg_count: 6, name: "sendto" },
    SyscallInfo { arg_count: 6, name: "recvfrom" },
    SyscallInfo { arg_count: 3, name: "sendmsg" },
    SyscallInfo { arg_count: 3, name: "recvmsg" },
    SyscallInfo { arg_count: 2, name: "shutdown" },
    SyscallInfo { arg_count: 3, name: "bind" },
    SyscallInfo { arg_count: 2, name: "listen" },
    SyscallInfo { arg_count: 3, name: "getsockname" },
    SyscallInfo { arg_count: 3, name: "getpeername" },
    SyscallInfo { arg_count: 4, name: "socketpair" },
    SyscallInfo { arg_count: 5, name: "setsockopt" },
    SyscallInfo { arg_count: 5, name: "getsockopt" },
    SyscallInfo { arg_count: 5, name: "clone" },
    SyscallInfo { arg_count: 0, name: "fork" },
    SyscallInfo { arg_count: 0, name: "vfork" },
    SyscallInfo { arg_count: 3, name: "execve" },
    SyscallInfo { arg_count: 1, name: "_exit" },
    SyscallInfo { arg_count: 4, name: "wait4" },
    SyscallInfo { arg_count: 2, name: "kill" },
    SyscallInfo { arg_count: 1, name: "uname" },
    SyscallInfo { arg_count: 3, name: "semget" },
    SyscallInfo { arg_count: 3, name: "semop" },
    SyscallInfo { arg_count: 4, name: "semctl" },
    SyscallInfo { arg_count: 1, name: "shmdt" },
    SyscallInfo { arg_count: 2, name: "msgget" },
    SyscallInfo { arg_count: 4, name: "msgsnd" },
    SyscallInfo { arg_count: 5, name: "msgrcv" },
    SyscallInfo { arg_count: 3, name: "msgctl" },
    SyscallInfo { arg_count: 3, name: "fcntl" },
    SyscallInfo { arg_count: 2, name: "flock" },
    SyscallInfo { arg_count: 1, name: "fsync" },
    SyscallInfo { arg_count: 1, name: "fdatasync" },
    SyscallInfo { arg_count: 2, name: "truncate" },
    SyscallInfo { arg_count: 2, name: "ftruncate" },
    SyscallInfo { arg_count: 3, name: "getdents" },
    SyscallInfo { arg_count: 2, name: "getcwd" },
    SyscallInfo { arg_count: 1, name: "chdir" },
    SyscallInfo { arg_count: 1, name: "fchdir" },
    SyscallInfo { arg_count: 2, name: "rename" },
    SyscallInfo { arg_count: 2, name: "mkdir" },
    SyscallInfo { arg_count: 1, name: "rmdir" },
    SyscallInfo { arg_count: 2, name: "creat" },
    SyscallInfo { arg_count: 2, name: "link" },
    SyscallInfo { arg_count: 1, name: "unlink" },
    SyscallInfo { arg_count: 2, name: "symlink" },
    SyscallInfo { arg_count: 3, name: "readlink" },
    SyscallInfo { arg_count: 2, name: "chmod" },
    SyscallInfo { arg_count: 2, name: "fchmod" },
    SyscallInfo { arg_count: 3, name: "chown" },
    SyscallInfo { arg_count: 3, name: "fchown" },
    SyscallInfo { arg_count: 3, name: "lchown" },
    SyscallInfo { arg_count: 1, name: "umask" },
    SyscallInfo { arg_count: 2, name: "gettimeofday" },
    SyscallInfo { arg_count: 2, name: "getrlimit" },
    SyscallInfo { arg_count: 2, name: "getrusage" },
    SyscallInfo { arg_count: 1, name: "sysinfo" },
    SyscallInfo { arg_count: 1, name: "times" },
    SyscallInfo { arg_count: 4, name: "ptrace" },
    SyscallInfo { arg_count: 0, name: "getuid" },
    SyscallInfo { arg_count: 3, name: "syslog" },
    SyscallInfo { arg_count: 0, name: "getgid" },
    SyscallInfo { arg_count: 1, name: "setuid" },
    SyscallInfo { arg_count: 1, name: "setgid" },
    SyscallInfo { arg_count: 0, name: "geteuid" },
    SyscallInfo { arg_count: 0, name: "getegid" },
    SyscallInfo { arg_count: 2, name: "setpgid" },
    SyscallInfo { arg_count: 0, name: "getppid" },
    SyscallInfo { arg_count: 0, name: "getpgrp" },
    SyscallInfo { arg_count: 0, name: "setsid" },
    SyscallInfo { arg_count: 2, name: "setreuid" },
    SyscallInfo { arg_count: 2, name: "setregid" },
    SyscallInfo { arg_count: 2, name: "getgroups" },
    SyscallInfo { arg_count: 2, name: "setgroups" },
    SyscallInfo { arg_count: 3, name: "setresuid" },
    SyscallInfo { arg_count: 3, name: "getresuid" },
    SyscallInfo { arg_count: 3, name: "setresgid" },
    SyscallInfo { arg_count: 3, name: "getresgid" },
    SyscallInfo { arg_count: 1, name: "getpgid" },
    SyscallInfo { arg_count: 1, name: "setfsuid" },
    SyscallInfo { arg_count: 1, name: "setfsgid" },
    SyscallInfo { arg_count: 1, name: "getsid" },
    SyscallInfo { arg_count: 2, name: "capget" },
    SyscallInfo { arg_count: 2, name: "capset" },
    SyscallInfo { arg_count: 2, name: "rt_sigpending" },
    SyscallInfo { arg_count: 4, name: "rt_sigtimedwait" },
    SyscallInfo { arg_count: 3, name: "rt_sigqueueinfo" },
    SyscallInfo { arg_count: 2, name: "rt_sigsuspend" },
    SyscallInfo { arg_count: 2, name: "sigaltstack" },
    SyscallInfo { arg_count: 2, name: "utime" },
    SyscallInfo { arg_count: 3, name: "mknod" },
    SyscallInfo { arg_count: 1, name: "uselib" },
    SyscallInfo { arg_count: 1, name: "personality" },
    SyscallInfo { arg_count: 2, name: "ustat" },
    SyscallInfo { arg_count: 2, name: "statfs" },
    SyscallInfo { arg_count: 2, name: "fstatfs" },
    SyscallInfo { arg_count: 3, name: "sysfs" },
    SyscallInfo { arg_count: 2, name: "getpriority" },
    SyscallInfo { arg_count: 3, name: "setpriority" },
    SyscallInfo { arg_count: 2, name: "sched_setparam" },
    SyscallInfo { arg_count: 2, name: "sched_getparam" },
    SyscallInfo { arg_count: 3, name: "sched_setscheduler" },
    SyscallInfo { arg_count: 1, name: "sched_getscheduler" },
    SyscallInfo { arg_count: 1, name: "sched_get_priority_max" },
    SyscallInfo { arg_count: 1, name: "sched_get_priority_min" },
    SyscallInfo { arg_count: 2, name: "sched_rr_get_interval" },
    SyscallInfo { arg_count: 2, name: "mlock" },
    SyscallInfo { arg_count: 2, name: "munlock" },
    SyscallInfo { arg_count: 1, name: "mlockall" },
    SyscallInfo { arg_count: 0, name: "munlockall" },
    SyscallInfo { arg_count: 0, name: "vhangup" },
    SyscallInfo { arg_count: 3, name: "modify_ldt" },
    SyscallInfo { arg_count: 2, name: "pivot_root" },
    SyscallInfo { arg_count: 1, name: "_sysctl" },
    SyscallInfo { arg_count: 5, name: "prctl" },
    SyscallInfo { arg_count: 2, name: "arch_prctl" },
    SyscallInfo { arg_count: 1, name: "adjtimex" },
    SyscallInfo { arg_count: 2, name: "setrlimit" },
    SyscallInfo { arg_count: 1, name: "chroot" },
    SyscallInfo { arg_count: 0, name: "sync" },
    SyscallInfo { arg_count: 1, name: "acct" },
    SyscallInfo { arg_count: 2, name: "settimeofday" },
    SyscallInfo { arg_count: 5, name: "mount" },
    SyscallInfo { arg_count: 2, name: "umount2" },
    SyscallInfo { arg_count: 2, name: "swapon" },
    SyscallInfo { arg_count: 1, name: "swapoff" },
    SyscallInfo { arg_count: 4, name: "reboot" },
    SyscallInfo { arg_count: 2, name: "sethostname" },
    SyscallInfo { arg_count: 2, name: "setdomainname" },
    SyscallInfo { arg_count: 1, name: "iopl" },
    SyscallInfo { arg_count: 3, name: "ioperm" },
    SyscallInfo { arg_count: 2, name: "create_module" },
    SyscallInfo { arg_count: 3, name: "init_module" },
    SyscallInfo { arg_count: 2, name: "delete_module" },
    SyscallInfo { arg_count: 1, name: "get_kernel_syms" },
    SyscallInfo { arg_count: 5, name: "query_module" },
    SyscallInfo { arg_count: 4, name: "quotactl" },
    SyscallInfo { arg_count: 3, name: "nfsservctl" },
    SyscallInfo { arg_count: 5, name: "getpmsg" },
    SyscallInfo { arg_count: 5, name: "putpmsg" },
    SyscallInfo { arg_count: 5, name: "afs_syscall" },
    SyscallInfo { arg_count: 3, name: "tuxcall" },
    SyscallInfo { arg_count: 3, name: "security" },
    SyscallInfo { arg_count: 0, name: "gettid" },
    SyscallInfo { arg_count: 3, name: "readahead" },
    SyscallInfo { arg_count: 5, name: "setxattr" },
    SyscallInfo { arg_count: 5, name: "lsetxattr" },
    SyscallInfo { arg_count: 5, name: "fsetxattr" },
    SyscallInfo { arg_count: 4, name: "getxattr" },
    SyscallInfo { arg_count: 4, name: "lgetxattr" },
    SyscallInfo { arg_count: 4, name: "fgetxattr" },
    SyscallInfo { arg_count: 3, name: "listxattr" },
    SyscallInfo { arg_count: 3, name: "llistxattr" },
    SyscallInfo { arg_count: 3, name: "flistxattr" },
    SyscallInfo { arg_count: 2, name: "removexattr" },
    SyscallInfo { arg_count: 2, name: "lremovexattr" },
    SyscallInfo { arg_count: 2, name: "fremovexattr" },
    SyscallInfo { arg_count: 2, name: "tkill" },
    SyscallInfo { arg_count: 1, name: "time" },
    SyscallInfo { arg_count: 6, name: "futex" },
    SyscallInfo { arg_count: 3, name: "sched_setaffinity" },
    SyscallInfo { arg_count: 3, name: "sched_getaffinity" },
    SyscallInfo { arg_count: 1, name: "set_thread_area" },
    SyscallInfo { arg_count: 2, name: "io_setup" },
    SyscallInfo { arg_count: 1, name: "io_destroy" },
    SyscallInfo { arg_count: 5, name: "io_getevents" },
    SyscallInfo { arg_count: 3, name: "io_submit" },
    SyscallInfo { arg_count: 3, name: "io_cancel" },
    SyscallInfo { arg_count: 1, name: "get_thread_area" },
    SyscallInfo { arg_count: 3, name: "lookup_dcookie" },
    SyscallInfo { arg_count: 1, name: "epoll_create" },
    SyscallInfo { arg_count: 4, name: "epoll_ctl_old" },
    SyscallInfo { arg_count: 4, name: "epoll_wait_old" },
    SyscallInfo { arg_count: 5, name: "remap_file_pages" },
    SyscallInfo { arg_count: 3, name: "getdents64" },
    SyscallInfo { arg_count: 1, name: "set_tid_address" },
    SyscallInfo { arg_count: 0, name: "restart_syscall" },
    SyscallInfo { arg_count: 4, name: "semtimedop" },
    SyscallInfo { arg_count: 4, name: "fadvise64" },
    SyscallInfo { arg_count: 3, name: "timer_create" },
    SyscallInfo { arg_count: 4, name: "timer_settime" },
    SyscallInfo { arg_count: 2, name: "timer_gettime" },
    SyscallInfo { arg_count: 1, name: "timer_getoverrun" },
    SyscallInfo { arg_count: 1, name: "timer_delete" },
    SyscallInfo { arg_count: 2, name: "clock_settime" },
    SyscallInfo { arg_count: 2, name: "clock_gettime" },
    SyscallInfo { arg_count: 2, name: "clock_getres" },
    SyscallInfo { arg_count: 4, name: "clock_nanosleep" },
    SyscallInfo { arg_count: 1, name: "exit_group" },
    SyscallInfo { arg_count: 4, name: "epoll_wait" },
    SyscallInfo { arg_count: 4, name: "epoll_ctl" },
    SyscallInfo { arg_count: 3, name: "tgkill" },
    SyscallInfo { arg_count: 2, name: "utimes" },
    SyscallInfo { arg_count: 5, name: "vserver" },
    SyscallInfo { arg_count: 6, name: "mbind" },
    SyscallInfo { arg_count: 3, name: "set_mempolicy" },
    SyscallInfo { arg_count: 5, name: "get_mempolicy" },
    SyscallInfo { arg_count: 4, name: "mq_open" },
    SyscallInfo { arg_count: 1, name: "mq_unlink" },
    SyscallInfo { arg_count: 5, name: "mq_timedsend" },
    SyscallInfo { arg_count: 5, name: "mq_timedreceive" },
    SyscallInfo { arg_count: 2, name: "mq_notify" },
    SyscallInfo { arg_count: 3, name: "mq_getsetattr" },
    SyscallInfo { arg_count: 4, name: "kexec_load" },
    SyscallInfo { arg_count: 5, name: "waitid" },
    SyscallInfo { arg_count: 5, name: "add_key" },
    SyscallInfo { arg_count: 4, name: "request_key" },
    SyscallInfo { arg_count: 5, name: "keyctl" },
    SyscallInfo { arg_count: 3, name: "ioprio_set" },
    SyscallInfo { arg_count: 2, name: "ioprio_get" },
    SyscallInfo { arg_count: 0, name: "inotify_init" },
    SyscallInfo { arg_count: 3, name: "inotify_add_watch" },
    SyscallInfo { arg_count: 2, name: "inotify_rm_watch" },
    SyscallInfo { arg_count: 4, name: "migrate_pages" },
    SyscallInfo { arg_count: 4, name: "openat" },
    SyscallInfo { arg_count: 3, name: "mkdirat" },
    SyscallInfo { arg_count: 4, name: "mknodat" },
    SyscallInfo { arg_count: 5, name: "fchownat" },
    SyscallInfo { arg_count: 3, name: "futimesat" },
    SyscallInfo { arg_count: 4, name: "newfstatat" },
    SyscallInfo { arg_count: 3, name: "unlinkat" },
    SyscallInfo { arg_count: 4, name: "renameat" },
    SyscallInfo { arg_count: 5, name: "linkat" },
    SyscallInfo { arg_count: 3, name: "symlinkat" },
    SyscallInfo { arg_count: 4, name: "readlinkat" },
    SyscallInfo { arg_count: 3, name: "fchmodat" },
    SyscallInfo { arg_count: 3, name: "faccessat" },
    SyscallInfo { arg_count: 6, name: "pselect6" },
    SyscallInfo { arg_count: 5, name: "ppoll" },
    SyscallInfo { arg_count: 1, name: "unshare" },
    SyscallInfo { arg_count: 2, name: "set_robust_list" },
    SyscallInfo { arg_count: 3, name: "get_robust_list" },
    SyscallInfo { arg_count: 6, name: "splice" },
    SyscallInfo { arg_count: 4, name: "tee" },
    SyscallInfo { arg_count: 4, name: "sync_file_range" },
    SyscallInfo { arg_count: 4, name: "vmsplice" },
    SyscallInfo { arg_count: 6, name: "move_pages" },
    SyscallInfo { arg_count: 4, name: "utimensat" },
    SyscallInfo { arg_count: 6, name: "epoll_pwait" },
    SyscallInfo { arg_count: 3, name: "signalfd" },
    SyscallInfo { arg_count: 2, name: "timerfd_create" },
    SyscallInfo { arg_count: 1, name: "eventfd" },
    SyscallInfo { arg_count: 4, name: "fallocate" },
    SyscallInfo { arg_count: 4, name: "timerfd_settime" },
    SyscallInfo { arg_count: 2, name: "timerfd_gettime" },
    SyscallInfo { arg_count: 4, name: "accept4" },
    SyscallInfo { arg_count: 4, name: "signalfd4" },
    SyscallInfo { arg_count: 2, name: "eventfd2" },
    SyscallInfo { arg_count: 1, name: "epoll_create1" },
    SyscallInfo { arg_count: 3, name: "dup3" },
    SyscallInfo { arg_count: 2, name: "pipe2" },
    SyscallInfo { arg_count: 1, name: "inotify_init1" },
    SyscallInfo { arg_count: 4, name: "preadv" },
    SyscallInfo { arg_count: 4, name: "pwritev" },
    SyscallInfo { arg_count: 4, name: "rt_tgsigqueueinfo" },
    SyscallInfo { arg_count: 5, name: "perf_event_open" },
    SyscallInfo { arg_count: 5, name: "recvmmsg" },
    SyscallInfo { arg_count: 2, name: "fanotify_init" },
    SyscallInfo { arg_count: 5, name: "fanotify_mark" },
    SyscallInfo { arg_count: 4, name: "prlimit64" },
    SyscallInfo { arg_count: 5, name: "name_to_handle_at" },
    SyscallInfo { arg_count: 3, name: "open_by_handle_at" },
    SyscallInfo { arg_count: 2, name: "clock_adjtime" },
    SyscallInfo { arg_count: 1, name: "syncfs" },
    SyscallInfo { arg_count: 4, name: "sendmmsg" },
    SyscallInfo { arg_count: 2, name: "setns" },
    SyscallInfo { arg_count: 3, name: "getcpu" },
    SyscallInfo { arg_count: 6, name: "process_vm_readv" },
    SyscallInfo { arg_count: 6, name: "process_vm_writev" },
    SyscallInfo { arg_count: 5, name: "kcmp" },
    SyscallInfo { arg_count: 3, name: "finit_module" },
    SyscallInfo { arg_count: 3, name: "sched_setattr" },
    SyscallInfo { arg_count: 4, name: "sched_getattr" },
    SyscallInfo { arg_count: 5, name: "renameat2" },
    SyscallInfo { arg_count: 3, name: "seccomp" },
    SyscallInfo { arg_count: 3, name: "getrandom" },
    SyscallInfo { arg_count: 2, name: "memfd_create" },
    SyscallInfo { arg_count: 5, name: "kexec_file_load" },
    SyscallInfo { arg_count: 3, name: "bpf" },
    SyscallInfo { arg_count: 5, name: "execveat" },
];
